<h1>WMChat</h1>

<hr/>

<div *ngIf="structuralControl.showAddMessageChannelPopup" 
     class="modal.show"
     tabindex="-1"
     role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add message channel</h5>
            </div>
            <div class="modal-body">
                <div>
                    <label class="col-form-label key-label">Title</label>
                    <input placeholder="Optional" 
                           [(ngModel)]="createMessageChannelForm.title"
                           class="value-label" />
                </div>
                
                <div>
                    <label class="col-form-label key-label">Description</label>
                    <input placeholder="Optional" 
                           [(ngModel)]="createMessageChannelForm.description"
                           class="value-label" />
                </div>

                <div>
                    <label class="col-form-label key-label">Members</label>
                    <span class="value-label">
                        <input placeholder="Search contacts..." />
                        <button class="btn">+</button>
                    </span>
                </div>

                <div>
                    <input type="checkbox" />
                    <label class="col-form-label">Close group</label>
                </div>
            </div>
            <div class="modal-footer">
                <button *ngIf="!structuralControl.onCreatingMessageChannel"
                        (click)="onClickConfirmCreateMessageChannel"
                        type="button" 
                        class="btn">
                    Add
                </button>
                <button *ngIf="structuralControl.onCreatingMessageChannel"
                        class="btn">
                    Creating...
                </button>

                <button (click)="onClickCancelCreateMessageChannel"
                        type="button"
                        class="btn"
                        data-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<div *ngIf="structuralControl.mode == WMMode.SEARCH_MESSAGE_CHANNEL">
    <div>
        <input #searchBox (input)="onKeyDownSearchMessageChannel(searchBox.value)"
          class="searchbar" placeholder="Search message channels.." />

        <button (click)="onClickCreateMessageChannel"
                class="btn">+</button>

        <img *ngIf="structuralControl.onLoadingMessageChannels" 
             src="icons/cpu.svg" 
             width="40em" 
             height="40em" />
    </div>

    <hr/>

    <div *ngIf="structuralControl.onLoadingMessageChannels">
        Loading...
    </div>
    
    <div *ngIf="!structuralControl.onLoadingMessageChannels" 
         class="message-channel-list">
        <label *ngIf="structuralControl.messageChannelOverviews.isEmpty" 
           class="col-form-label section">
           No message channel found.
        </label>
    
        <ul class="list-group section">
            <li *ngFor="let overview of structuralControl.messageChannelOverviews"
                (click)="onClickMessageChannel(overview)"
                class="list-group-item">
                <h5 *ngIf="overview.channel.hasTitle()">
                    {{overview.channel.title}}
                </h5>
                <h5 *ngIf="!overview.channel.hasTitle()">
                    No title
                </h5>

                <br>

                <p *ngIf="overview.channel.hasDescription()">
                    {{overview.channel.description}}
                </p>
                <p *ngIf="!overview.channel.hasDescription()">
                    empty description
                </p>

                <br>

                <label *ngIf="!overview.mostActiveUsers.isEmpty">
                    Active members: 
                    <span *ngFor="let member of 
                                  overview.mostActiveUsers">
                        <label *ngIf="member.alias.hasValue()">
                            {{member.alias.value}},
                        </label>

                        <label *ngIf="!member.alias.hasValue()">
                            {{member.userId}},
                        </label>
                    </span>
                    <label>...</label>
                </label>

                <br>

                <label>
                    Last interacted at 
                    {{
                        dateToString(overview.channelLastInteractedAt)
                    }}
                </label>

                <br>

                <label>
                    Created at {{dateToString(overview.channel.createdAt)}}
                </label>
            </li>
        </ul>
    </div>
</div>

<div *ngIf="structuralControl.mode == WMMode.VIEW_MESSAGE_CHANNEL">
    Not implemented.
</div>

<e8yes-footer></e8yes-footer>
